<?xml version="1.0" encoding="UTF-8" ?>
<features name="minion-taskset-${project.version}" xmlns="http://karaf.apache.org/xmlns/features/v1.6.0">

    <feature name="taskset-guava-internal">
        <bundle>mvn:com.google.guava/guava/${guava.version}</bundle>
        <bundle dependency="true">mvn:com.google.guava/failureaccess/1.0.1</bundle>
    </feature>

    <feature name="taskset-gson-internal">
        <bundle>mvn:com.google.code.gson/gson/${gson.version}</bundle>
    </feature>

    <feature name="taskset-horizon-core-lib-internal" version="${project.version}">
        <feature prerequisite="true">wrap</feature>
        <bundle>wrap:mvn:org.opennms.horizon.core/lib/${opennms-horizon.version}$overwrite=merge&amp;Import-Package=*;resolution:=optional</bundle>
    </feature>

    <feature name="taskset-plugins-api" version="${project.version}">
        <feature>taskset-horizon-core-lib-internal</feature>
        <bundle>mvn:org.opennms.horizon.minion/plugins-api/${project.version}</bundle>
    </feature>

    <feature name="taskset-worker-plugin-registration-internal" description="Plugin registration plugin-registration" version="${project.version}">
        <feature>aries-blueprint</feature>
        <feature>ipc-minion</feature>
        <feature>camel-blueprint</feature>
        <feature>taskset-model</feature>
        <feature>taskset-plugins-api</feature>
        <bundle>mvn:org.opennms.horizon.minion/registration/${project.version}</bundle>
    </feature>

    <feature name="eos" description="Savoirtech EOS Whiteboard" version="${project.version}">
        <bundle dependency="true">mvn:org.apache.commons/commons-lang3/3.4</bundle>
        <bundle dependency="true">mvn:com.google.guava/guava/18.0</bundle>
        <bundle dependency="true">mvn:com.savoirtech.eos/eos-core/${eos.version}</bundle>
    </feature>

    <feature name="taskset-rest-utils-internal" version="${project.version}">
        <feature>cxf</feature>
        <feature>cxf-jaxrs</feature>
        <feature>cxf-sse</feature>
        <feature>cxf-rs-description-openapi-v3</feature>
        <feature>cxf-rs-security-oauth2</feature>

        <bundle>mvn:org.apache.aries.component-dsl/org.apache.aries.component-dsl.component-dsl/1.2.2</bundle>
        <bundle>mvn:org.apache.aries.jax.rs/org.apache.aries.jax.rs.openapi.resource/${aries.jax.rs.whiteboard.version}</bundle>
        <feature>aries-jax-rs-whiteboard</feature>
        <feature>aries-jax-rs-whiteboard-jackson</feature>
        <bundle>mvn:javax.annotation/javax.annotation-api/1.3.2</bundle>

    </feature>

    <feature name="taskset-model" version="${project.version}">
        <bundle>mvn:org.opennms.horizon.shared/task-set/${project.version}</bundle>
        <bundle>mvn:org.opennms.horizon.minion/model/${project.version}</bundle>
    </feature>

    <feature name="taskset-scheduler-internal" version="${project.version}">
        <feature dependency="true">wrap</feature>
        <feature>aries-blueprint</feature>
        <bundle>wrap:mvn:com.cronutils/cron-utils/${cron-utils.version}$overwrite=merge&amp;Import-Package=javax.validation;resolution:=optional,*</bundle>
        <bundle>mvn:org.opennms.horizon.minion.taskset/taskset-scheduler/${project.version}</bundle>
    </feature>

    <feature name="taskset-worker-ignite-internal" version="${project.version}">
        <feature>aries-blueprint</feature>
        <feature>camel-core</feature>
        <feature>cxf-jackson</feature>
        <feature>eos</feature>
        <feature>ipc-minion</feature>
        <feature>observability-minion</feature>
        <feature>taskset-model</feature>
        <feature>taskset-worker-plugin-registration-internal</feature>
        <feature>taskset-scheduler-internal</feature>
        <feature>taskset-guava-internal</feature>
        <feature>taskset-ignite-core-internal</feature>
        <feature>taskset-rest-utils-internal</feature>

        <bundle>wrap:mvn:org.apache.ignite/ignite-kubernetes/${ignite.version}</bundle>
    </feature>

    <feature name="taskset-ignite-core-internal" version="${project.version}">
        <bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.javax-cache-api/1.0.0_1</bundle>
        <bundle dependency="true">wrap:mvn:org.apache.ignite/ignite-osgi/${ignite.version}</bundle>
        <bundle>wrap:mvn:org.apache.ignite/ignite-core/${ignite.version}$DynamicImport-Package=*</bundle>
    </feature>

    <feature name="taskset-minion" version="${project.version}">
        <feature>ipc-minion</feature>
        <feature>observability-minion</feature>
        <feature>taskset-gson-internal</feature>
        <feature>taskset-worker-ignite-internal</feature>

        <bundle>mvn:org.opennms.horizon.minion.taskset/taskset-ipc/${project.version}</bundle>
        <bundle>mvn:org.opennms.horizon.minion.taskset/taskset-worker/${project.version}</bundle>
    </feature>

</features>
